---
title: JavaScript立即执行函数 (function(){...})(jQuery)
date: 2017-06-06 21:32:20
categories: JavaScript
tags:
- 函数
---

今天意外发掘JavaScript中一个不广为人知，且超实用的函数--立即执行函数，这个函数被广泛应用于各类插件js中，通常它的写法是(function(){...})()包住业务代码，使用jQuery时比较常见。
<!-- more -->

#### 首先，说明一下这样写法有什么作用？

因为javascript中没有私有作用域的概念，如果在某个项目开发中涉及多人配合开发，那么你在全局或局部作用域中声明的一些变量，可能会被其他人声明的同名变量覆盖。
根据javascript函数作用域链的特性，可以使用这种技术模仿一个私有作用域，用匿名函数作为一个“容易”，“容器”内部可以访问外部的变量，而外部环境不能访问“容器”内部的变量，所以是(function(){...})()就避免了内部变量和外部变量发生冲突。

#### 函数声明、函数表达式、匿名函数

理解一些函数的基本概念：
（1）函数声明：使用function声明函数，指定一个函数名
```
function fnName() { ... }
```
（2）函数表达式：使用function关键字声明一个函数，但未给函数命名，最后将匿名函数赋予一个变量
```
var fnName = function() { ... }
```
（3）匿名函数：使用function关键字声明一个函数，但未给函数命名
```
function() { ... }
```
注：匿名函数属于函数表达式

#### 函数声明和函数表达式不同之处
介绍一下函数声明和函数表达式不同之处，你会知道原来javascript还可以这么写。
函数声明和函数表达式不同之处在于，
（1）Javascript引擎在解析javascript代码时会‘函数声明提升'（Function declaration Hoisting）当前执行环境（作用域）上的函数声明，而函数表达式必须等到Javascirtp引擎执行到它所在行时，才会从上而下一行一行地解析函数表达式。
（2）函数表达式后面可以加括号立即调用该函数，函数声明不可以，只能以fnName()形式调用 。

附上代码
```
fnName(); // 函数调用
function fnName() { ... } // 函数声明
// 这种写法是没有毛病的，因为函数声明被提升了，所以函数调用可在函数声明之前

fnName(); // 函数调用
var fnName = function() { ... } // 函数表达式
// 报错，变量fnName还未保存为对函数的引用，函数调用必须在函数表达式之后
```

在【函数表达式】后面加括号就能立即调用，下面是立即执行函数的例子
```
// （）、！、+、-、=等运算符，都可以将函数声明转换为表达式，在后面加括号，可以立即执行函数

=！+-function(a){
    console.log(a); // 输出123
}(123)

(function(a){
    console.log(a); // 输出123
})(123);
// 加括号是最安全的做法，因为！、+、-等运算符还会和函数的返回值进行运算，有时造成不必要的麻烦。
```

拓展：JQuery使用的就是这种方法，将JQuery代码包裹在(function(window,undefined){ …jquery代码… }(window)中，在全局作用域中调用JQuery代码时，可以达到保护JQuery内部变量的作用。